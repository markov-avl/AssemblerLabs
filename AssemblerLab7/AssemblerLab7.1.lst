Microsoft (R) Macro Assembler Version 14.28.29336.0	    05/21/21 03:08:21
src.asm							     Page 1 - 1


				PUBLIC masm

				.686
				.model flat, C
				option casemap : none

 = 00000080			BUFFER_SIZE      = 128
 =-0000000A			STD_INPUT_HANDLE = -10

 00000000			.data

 00000000 00000000		outputHandler dd 0
 00000004 00000000		inputHandler  dd 0
 00000008 00000000		fileHandler   dd 0

 0000000C 00000000		nRead         dd 0
 00000010 00000000		bytesWritten  dd 0

 00000014  00000080 [		consoleFile   db BUFFER_SIZE DUP(?)
	    00
	   ]
 00000094 6F 75 74 70 75	filename      db "output.txt", 0
	   74 2E 74 78 74
	   00

 00000000			.code

				EXTERN stdHandle:PROC
				EXTERN readConsole:PROC
				EXTERN createFile:PROC
				EXTERN writeFile:PROC
				EXTERN closeHandle:PROC
				EXTERN exitProcess:PROC

 00000000			masm PROC

 00000000  55			push ebp
 00000001  8B EC		mov  ebp, esp

				; меняем дескриптор на считывание
 00000003  6A F6		push STD_INPUT_HANDLE
 00000005  E8 00000000 E	call stdHandle
 0000000A  A3 00000004 R	mov  inputHandler, eax

				; получаем ввод с консоли
 0000000F  6A 00		push 0
 00000011  68 0000000C R	push offset nRead
 00000016  68 00000080		push BUFFER_SIZE
 0000001B  68 00000014 R	push offset consoleFile
 00000020  FF 35 00000004 R	push inputHandler
 00000026  E8 00000000 E	call readConsole

				; создаем файл output.txt, если он не создан
 0000002B  6A 00		push 0
 0000002D  68 00000080		push 80h
 00000032  6A 02		push 2
 00000034  6A 00		push 0
 00000036  6A 02		push 2h
 00000038  6A 02		push 2
 0000003A  68 00000094 R	push offset filename
 0000003F  E8 00000000 E	call createFile
 00000044  A3 00000008 R	mov  fileHandler, eax

				; записываем в файл введеную строку
 00000049  6A 00		push 0
 0000004B  68 00000010 R	push offset bytesWritten
 00000050  FF 35 0000000C R	push nRead
 00000056  68 00000014 R	push offset consoleFile
 0000005B  FF 35 00000008 R	push fileHandler
 00000061  E8 00000000 E	call writeFile

				; закрываем файл
 00000066  FF 35 00000008 R	push fileHandler
 0000006C  E8 00000000 E	call closeHandle

				; выходим из процедуры
 00000071  6A 00		push 0
 00000073  E8 00000000 E	call exitProcess

 00000078  8B E5		mov  esp, ebp
 0000007A  5D			pop  ebp
 0000007B  C3			retn
 0000007C			masm ENDP

				END
				end Main
Microsoft (R) Macro Assembler Version 14.28.29336.0	    05/21/21 03:08:21
src.asm							     Symbols 2 - 1




Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

FLAT . . . . . . . . . . . . . .	GROUP
_DATA  . . . . . . . . . . . . .	32 Bit	 0000009F Para	  Public  'DATA'	
_TEXT  . . . . . . . . . . . . .	32 Bit	 0000007C Para	  Public  'CODE'	


Procedures, parameters, and locals:

                N a m e                 Type     Value    Attr

masm . . . . . . . . . . . . . .	P Near	 00000000 _TEXT	Length= 0000007C Public C


Symbols:

                N a m e                 Type     Value    Attr

@CodeSize  . . . . . . . . . . .	Number	 00000000h   
@DataSize  . . . . . . . . . . .	Number	 00000000h   
@Interface . . . . . . . . . . .	Number	 00000001h   
@Model . . . . . . . . . . . . .	Number	 00000007h   
@code  . . . . . . . . . . . . .	Text   	 _TEXT
@data  . . . . . . . . . . . . .	Text   	 FLAT
@fardata?  . . . . . . . . . . .	Text   	 FLAT
@fardata . . . . . . . . . . . .	Text   	 FLAT
@stack . . . . . . . . . . . . .	Text   	 FLAT
BUFFER_SIZE  . . . . . . . . . .	Number	 00000080h   
STD_INPUT_HANDLE . . . . . . . .	Number	 -0000000Ah   
bytesWritten . . . . . . . . . .	DWord	 00000010 _DATA	
closeHandle  . . . . . . . . . .	L Near	 00000000 FLAT	External C
consoleFile  . . . . . . . . . .	Byte	 00000014 _DATA	
createFile . . . . . . . . . . .	L Near	 00000000 FLAT	External C
exitProcess  . . . . . . . . . .	L Near	 00000000 FLAT	External C
fileHandler  . . . . . . . . . .	DWord	 00000008 _DATA	
filename . . . . . . . . . . . .	Byte	 00000094 _DATA	
inputHandler . . . . . . . . . .	DWord	 00000004 _DATA	
nRead  . . . . . . . . . . . . .	DWord	 0000000C _DATA	
outputHandler  . . . . . . . . .	DWord	 00000000 _DATA	
readConsole  . . . . . . . . . .	L Near	 00000000 FLAT	External C
stdHandle  . . . . . . . . . . .	L Near	 00000000 FLAT	External C
writeFile  . . . . . . . . . . .	L Near	 00000000 FLAT	External C

	   0 Warnings
	   0 Errors
